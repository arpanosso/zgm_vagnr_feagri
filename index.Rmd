---
title: "Análise Feagri - Vagner & Zigomar"
author: "Alan R Panosso"
date: "22/03/2021"
output: html_document
---

# Carregando Pacotes

```{r, message=FALSE}
library(tidyverse)
library(vegan)
```

# Entrada de dados
```{r}
dados <- read.table("https://raw.githubusercontent.com/arpanosso/zgm_vagnr_feagri/main/dados/Dados_gerais.txt",
                           h=TRUE,
                           na.strings = "",
                           sep="\t",
                           stringsAsFactors = TRUE)
glimpse(dados)
```

# Validação de dados  
## Análise de estatística descritiva  

```{r}
# criando função para estatística descritiva
estat_desc <- function(x){
  x<-na.omit(x)
  media <- mean(x)
  mediana <- median(x)
  dp <- sd(x)
  cv <- 100*dp/media
  MIN <- min(x)
  MAX <- max(x)
  q1 <- quantile(x,0.25)
  q3 <- quantile(x,0.75)
  assi <- agricolae::skewness(x)
  curt <- agricolae::kurtosis(x)
  c(Mínimo = MIN, Q1=q1, Média=media, Med=mediana, Q3=q3, Máximo=MAX,
    DesvPad = dp, CV = cv,Assimetria=assi,Curtose=curt)
}
apply(dados[7:length(dados)], 2, estat_desc)
```

# Gráficos de histograma

```{r}
dados %>% 
  filter(!is.na(TeorH2O)) %>% 
  group_by(Estacao) %>% 
  ggplot(aes(x=TeorH2O)) +
  geom_histogram(bins=30,color="black",fill="gray")+
  facet_wrap(~Estacao + Profundidade, nrow = 3, scales = "free")+
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45))
```


# Dados de Macrofauna

```{r}
macrofauna <- read.table("https://raw.githubusercontent.com/arpanosso/zgm_vagnr_feagri/main/dados/Macrofauna_edafica_dados_gerais_analises.txt", 
                         h=TRUE,
                         sep="\t")
glimpse(macrofauna)
```

# Gráficos de contagem
```{r,message=FALSE}
macrofauna %>% 
  group_by(Estacao,Tratamento,Classe) %>% 
  summarise(contagem =n()) %>% 
  mutate(perc = contagem/sum(contagem)) %>% 
  ggplot(aes(x=Tratamento, y=perc, fill=Classe))+
  geom_col(position = "dodge") + 
  facet_wrap(~Estacao, scale="free") +
  theme_minimal()+
  coord_flip()
```

```{r}
macrofauna %>% 
  group_by(Estacao,Grupo) %>% 
  summarise(count =n()) %>% 
  ggplot(aes(x=Estacao, y=count,fill=Grupo))+
  geom_col(position = "dodge") + 
  theme_minimal()
```


# Gráficos de histograma

```{r}
macrofauna %>% 
  filter(!is.na(Tar)) %>% 
  group_by(Estacao) %>% 
  ggplot(aes(x=Tar)) +
  geom_histogram(bins=30,color="black",fill="gray")+
  facet_wrap(~Estacao + Profund, nrow = 3, scales = "free")+
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45))
```
